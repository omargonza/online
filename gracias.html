<!doctype html>
<html lang="es-AR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>¡Listo! Próximos pasos | Miss Noe</title>
  <meta name="description" content="Gracias por tu compra o consulta. Acá tenés los próximos pasos para acceder al curso asincrónico y soporte por WhatsApp." />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#d81b7d" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand:#d81b7d;
      --ink:#111827;
      --muted:#6B7280;
      --bg:#fff7fb;
      --card:#ffffff;
      --border:#f2d6e6;
      --shadow: 0 16px 40px rgba(0,0,0,.10);
      --r:22px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--ink)}
    .wrap{max-width:880px;margin:0 auto;padding:52px 16px}
    .top{
      display:flex;align-items:center;justify-content:space-between;gap:14px;margin-bottom:18px
    }
    .brand{
      display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit
    }
    .logo{
      width:44px;height:44px;border-radius:14px;background:#fff;border:1px solid var(--border);
      display:grid;place-items:center;box-shadow:0 10px 24px rgba(0,0,0,.08);
      overflow:hidden;
    }
    .logo img{width:100%;height:100%;object-fit:cover}
    .bt{
      display:flex;flex-direction:column;line-height:1.05
    }
    .bt strong{font-weight:900}
    .bt span{font-size:.92rem;color:var(--muted)}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--r);
      padding:26px;
      box-shadow:var(--shadow);
      text-align:left;
    }
    h1{
      font-family:"Playfair Display",serif;
      margin:0 0 8px;
      font-size:2.05rem;
      line-height:1.1;
    }
    .sub{margin:0 0 14px;color:var(--muted)}
    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      margin-top:14px;
    }
    @media (max-width:820px){
      .grid{grid-template-columns:1fr}
      .top{flex-direction:column;align-items:flex-start}
    }
    .panel{
      border:1px solid #f4e1ec;
      border-radius:18px;
      padding:16px;
      background:linear-gradient(180deg,#fff, #fff8fc);
    }
    .panel h2{
      margin:0 0 10px;
      font-size:1.05rem;
      letter-spacing:.2px;
    }
    .steps{margin:0;padding-left:18px}
    .steps li{margin:10px 0;color:#1f2937}
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      background:#fff; border:1px solid #f0cfe1;
      border-radius:999px; padding:8px 12px;
      color:#7a1a4b; font-weight:800; font-size:.95rem;
    }
    .meta{
      display:grid;grid-template-columns:1fr;gap:10px;margin-top:12px
    }
    .kv{
      background:#fff;border:1px solid #f0cfe1;border-radius:16px;padding:12px
    }
    .kv .k{font-size:.82rem;color:var(--muted);margin-bottom:4px}
    .kv .v{font-weight:900}
    .actions{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
    .btn{
      appearance:none;border:0;cursor:pointer;
      border-radius:14px;
      padding:12px 14px;
      font-weight:900;
      text-decoration:none;
      display:inline-flex;align-items:center;justify-content:center;
      gap:10px;
      transition:transform .05s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--brand);color:#fff}
    .btn-ghost{background:#fff;color:var(--brand);border:1px solid #f0cfe1}
    .btn-wa{background:#0b1f17;color:#fff}
    .small{font-size:.92rem;color:var(--muted);margin-top:10px;line-height:1.45}
    .footer{
      margin-top:16px;
      display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;
      color:var(--muted);font-size:.9rem
    }
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .warn{
      margin-top:12px;
      border:1px solid #ffe3ef;
      background:#fff5fa;
      border-radius:16px;
      padding:12px;
      color:#7a1a4b;
      font-weight:700;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <a class="brand" href="./index.html" aria-label="Volver al inicio">
        <div class="logo">
          <!-- Si tenés logo -->
          <img src="./assets/logo2.png" alt="Miss Noe" onerror="this.remove();">
        </div>
        <div class="bt">
          <strong>Miss Noe</strong>
          <span>Online English · Argentina</span>
        </div>
      </a>

      <span class="pill" id="statusPill">✔️ Solicitud recibida</span>
    </div>

    <div class="card">
      <h1 id="title">¡Gracias! Ya tenemos tu solicitud</h1>
      <p class="sub" id="subtitle">
        Te dejamos los próximos pasos para acceder al curso asincrónico y recibir soporte.
      </p>

      <div class="grid">
        <div class="panel">
          <h2>Próximos pasos</h2>
          <ol class="steps" id="stepsList">
            <li><strong>Confirmá tu pago</strong> (Mercado Pago). Si ya pagaste, seguí al paso 2.</li>
            <li><strong>Accedé al curso</strong> desde Google Classroom (link abajo).</li>
            <li><strong>Soporte por WhatsApp:</strong> contanos tu objetivo y te guiamos con el módulo ideal.</li>
          </ol>

          <div class="actions">
            <!-- Botón Classroom -->
            <a class="btn btn-primary" id="ctaClassroom" href="#" target="_blank" rel="noopener">
              Acceder al Classroom
            </a>

            <!-- Botón WhatsApp -->
            <a class="btn btn-wa" id="ctaWhats" href="#" target="_blank" rel="noopener">
              Soporte por WhatsApp
            </a>

            <!-- Volver -->
            <a class="btn btn-ghost" href="./index.html">
              Volver al inicio
            </a>
          </div>

          <p class="small" id="helpText">
            Si no podés entrar al Classroom, escribinos por WhatsApp y te ayudamos. Guardá el comprobante de Mercado Pago.
          </p>

          <div class="warn" id="missingLinks" style="display:none">
            Falta configurar el link de Classroom y/o WhatsApp en el código de <span class="mono">gracias.html</span>.
          </div>
        </div>

        <div class="panel">
          <h2>Tu info (para personalizar el plan)</h2>

          <div class="meta">
            <div class="kv">
              <div class="k">Objetivo</div>
              <div class="v" id="outGoal">A definir</div>
            </div>
            <div class="kv">
              <div class="k">Nivel estimado (test)</div>
              <div class="v" id="outLevel">A definir</div>
            </div>
            <div class="kv">
              <div class="k">Referencia</div>
              <div class="v mono" id="outRef">—</div>
            </div>
          </div>

          <p class="small">
            Esta información se toma del sitio (si elegiste objetivo o hiciste el test). Si está en “A definir”, no pasa nada:
            te ayudamos por WhatsApp.
          </p>
        </div>
      </div>

      <div class="footer">
        <div>© <span id="year"></span> · Miss Noe Online English</div>
        <div class="mono" id="siteRef"></div>
      </div>
    </div>
  </div>

  <script>
    // =======================
    // Configuración rápida (pegá los links reales)
    // =======================
    const WHATSAPP_PHONE = "541126483009";
    const BRAND_NAME = "Miss Noe Online English";

    // Link de Classroom (invitar/curso)
    const CLASSROOM_URL = ""; // <-- PEGAR ACÁ (ej: https://classroom.google.com/u/0/c/XXXX)

    // Opcional: link de Mercado Pago (si querés mostrarlo acá)
    const MP_CHECKOUT_URL = ""; // <-- PEGAR ACÁ si lo querés usar

    // Storage keys (mismo que main.js)
    const LS_GOAL = "missnoe_goal";
    const LS_LEVEL = "missnoe_level";
    const LS_TEST = "missnoe_leveltest_v1";

    function safeText(s){ return String(s || "").trim(); }

    function buildWhatsLink({goal, level, ref}) {
      const base = `https://wa.me/${WHATSAPP_PHONE}`;
      const parts = [
        `Hola ${BRAND_NAME}. Ya completé el formulario / pago y necesito acceso al curso (Classroom).`,
        goal ? `Objetivo: ${goal}.` : null,
        level ? `Nivel estimado: ${level}.` : null,
        ref ? `Referencia: ${ref}.` : null,
        `¿Me confirmás el acceso y los próximos pasos?`
      ].filter(Boolean);
      return `${base}?text=${encodeURIComponent(parts.join(" "))}`;
    }

    function readLocalState() {
      let goal = "";
      let level = "";
      try {
        goal = safeText(localStorage.getItem(LS_GOAL));
        level = safeText(localStorage.getItem(LS_LEVEL));

        // Si el nivel no está, intentar leer del estado del test
        if (!level) {
          const raw = localStorage.getItem(LS_TEST);
          if (raw) {
            const parsed = JSON.parse(raw);
            if (parsed && safeText(parsed.level)) level = safeText(parsed.level);
          }
        }
      } catch(_) {}
      return { goal, level };
    }

    function readQuery() {
      const u = new URL(window.location.href);
      // Si en el futuro agregás ?ref= o ?status=, lo soporta
      const ref = safeText(u.searchParams.get("ref"));
      const status = safeText(u.searchParams.get("status")); // paid | lead | ok
      return { ref, status };
    }

    function setText(id, value) {
      const el = document.getElementById(id);
      if (el) el.textContent = value;
    }

    function setHref(id, href) {
      const el = document.getElementById(id);
      if (el) el.href = href;
    }

    function init() {
      setText("year", String(new Date().getFullYear()));
      setText("siteRef", window.location.host ? `Origen: ${window.location.host}` : "");

      const { goal, level } = readLocalState();
      const { ref, status } = readQuery();

      setText("outGoal", goal || "A definir");
      setText("outLevel", level || "A definir");
      setText("outRef", ref || "—");

      // Títulos según contexto (si querés usar ?status=paid desde MP o manual)
      const title = document.getElementById("title");
      const subtitle = document.getElementById("subtitle");
      const pill = document.getElementById("statusPill");

      if (status === "paid") {
        if (title) title.textContent = "¡Pago confirmado! Te queda acceder al curso";
        if (subtitle) subtitle.textContent = "Entrá al Classroom desde el botón y, si necesitás, pedí soporte por WhatsApp.";
        if (pill) pill.textContent = "✔️ Pago recibido";
      } else if (status === "lead") {
        if (title) title.textContent = "¡Gracias! Ya recibimos tu consulta";
        if (subtitle) subtitle.textContent = "Te respondemos por WhatsApp con el plan ideal y el link de pago.";
        if (pill) pill.textContent = "✔️ Consulta recibida";
      }

      // Links
      const whats = buildWhatsLink({ goal, level, ref });
      setHref("ctaWhats", whats);

      if (safeText(CLASSROOM_URL)) {
        setHref("ctaClassroom", CLASSROOM_URL);
      } else {
        // Si no hay classroom, que el botón apunte a WhatsApp
        setHref("ctaClassroom", whats);
      }

      // Aviso si falta configurar links críticos
      const missing = document.getElementById("missingLinks");
      const missingClassroom = !safeText(CLASSROOM_URL);
      const missingWhats = !safeText(WHATSAPP_PHONE);
      if (missing && (missingClassroom || missingWhats)) {
        missing.style.display = "block";
      }
    }

    init();
  </script>
</body>
</html>
